{
  "info": {
    "name": "Cyber Security Handbook API",
    "description": "API collection for Scam Detection System",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Search",
      "item": [
        {
          "name": "Check URL - Safe",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 200', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Response has success field', function () {",
                  "    const jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('success');",
                  "});",
                  "",
                  "pm.test('Response has isSafe field', function () {",
                  "    const jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('isSafe');",
                  "});",
                  "",
                  "pm.test('Response structure is valid', function () {",
                  "    const jsonData = pm.response.json();",
                  "    pm.expect(jsonData.success).to.be.a('boolean');",
                  "    pm.expect(jsonData.isSafe).to.be.a('boolean');",
                  "    pm.expect(jsonData.message).to.be.a('string');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/search/check?url=google.com",
              "host": ["{{baseUrl}}"],
              "path": ["api", "search", "check"],
              "query": [
                {
                  "key": "url",
                  "value": "google.com"
                }
              ]
            }
          }
        },
        {
          "name": "Check URL - Invalid",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 400', function () {",
                  "    pm.response.to.have.status(400);",
                  "});",
                  "",
                  "pm.test('Error message is present', function () {",
                  "    const jsonData = pm.response.json();",
                  "    pm.expect(jsonData.success).to.be.false;",
                  "    pm.expect(jsonData.message).to.include('không hợp lệ');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/search/check?url=invalid-url",
              "host": ["{{baseUrl}}"],
              "path": ["api", "search", "check"],
              "query": [
                {
                  "key": "url",
                  "value": "invalid-url"
                }
              ]
            }
          }
        },
        {
          "name": "Bulk Check URLs",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 200', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Response has results array', function () {",
                  "    const jsonData = pm.response.json();",
                  "    pm.expect(jsonData.results).to.be.an('array');",
                  "});",
                  "",
                  "pm.test('Response has total and scamsFound', function () {",
                  "    const jsonData = pm.response.json();",
                  "    pm.expect(jsonData.total).to.be.a('number');",
                  "    pm.expect(jsonData.scamsFound).to.be.a('number');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"urls\": [\n    \"google.com\",\n    \"facebook.com\",\n    \"example.com\"\n  ]\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/search/bulk-check",
              "host": ["{{baseUrl}}"],
              "path": ["api", "search", "bulk-check"]
            }
          }
        }
      ]
    },
    {
      "name": "Newsfeed",
      "item": [
        {
          "name": "Get Newsfeed",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 200', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Response has data array', function () {",
                  "    const jsonData = pm.response.json();",
                  "    pm.expect(jsonData.data).to.be.an('array');",
                  "});",
                  "",
                  "pm.test('Response has pagination', function () {",
                  "    const jsonData = pm.response.json();",
                  "    pm.expect(jsonData.pagination).to.be.an('object');",
                  "    pm.expect(jsonData.pagination).to.have.property('currentPage');",
                  "    pm.expect(jsonData.pagination).to.have.property('totalPages');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/newsfeed?limit=10&page=1",
              "host": ["{{baseUrl}}"],
              "path": ["api", "newsfeed"],
              "query": [
                {
                  "key": "limit",
                  "value": "10"
                },
                {
                  "key": "page",
                  "value": "1"
                }
              ]
            }
          }
        },
        {
          "name": "Get Top Scams",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 200', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Response data is array', function () {",
                  "    const jsonData = pm.response.json();",
                  "    pm.expect(jsonData.data).to.be.an('array');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/newsfeed/top?limit=5",
              "host": ["{{baseUrl}}"],
              "path": ["api", "newsfeed", "top"],
              "query": [
                {
                  "key": "limit",
                  "value": "5"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "Reports",
      "item": [
        {
          "name": "Submit Report",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 201', function () {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "pm.test('Response has reportId', function () {",
                  "    const jsonData = pm.response.json();",
                  "    pm.expect(jsonData.data).to.have.property('reportId');",
                  "    pm.environment.set('reportId', jsonData.data.reportId);",
                  "});",
                  "",
                  "pm.test('Response has status', function () {",
                  "    const jsonData = pm.response.json();",
                  "    pm.expect(jsonData.data.status).to.equal('pending');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"url\": \"https://test-scam-{{$randomInt}}.com\",\n  \"reason\": \"This website is asking for credit card information suspiciously\",\n  \"scamType\": \"phishing\",\n  \"reporterInfo\": {\n    \"name\": \"Test User\",\n    \"email\": \"test@example.com\",\n    \"isAnonymous\": false\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/reports",
              "host": ["{{baseUrl}}"],
              "path": ["api", "reports"]
            }
          }
        },
        {
          "name": "Get Report Status",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 200', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Response has status field', function () {",
                  "    const jsonData = pm.response.json();",
                  "    pm.expect(jsonData.data).to.have.property('status');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/reports/status/{{reportId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "reports", "status", "{{reportId}}"]
            }
          }
        }
      ]
    },
    {
      "name": "Statistics",
      "item": [
        {
          "name": "Get Statistics",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 200', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Response has overview data', function () {",
                  "    const jsonData = pm.response.json();",
                  "    pm.expect(jsonData.data.overview).to.be.an('object');",
                  "    pm.expect(jsonData.data.overview).to.have.property('totalBlacklist');",
                  "    pm.expect(jsonData.data.overview).to.have.property('totalReports');",
                  "});",
                  "",
                  "pm.test('Response has scamsByType array', function () {",
                  "    const jsonData = pm.response.json();",
                  "    pm.expect(jsonData.data.scamsByType).to.be.an('array');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/stats",
              "host": ["{{baseUrl}}"],
              "path": ["api", "stats"]
            }
          }
        },
        {
          "name": "Get Trending Scams",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 200', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Response has period field', function () {",
                  "    const jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('period');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/stats/trending?days=7",
              "host": ["{{baseUrl}}"],
              "path": ["api", "stats", "trending"],
              "query": [
                {
                  "key": "days",
                  "value": "7"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "Blacklist",
      "item": [
        {
          "name": "Create Blacklist",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 201', function () {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "pm.test('Response has data object', function () {",
                  "    const jsonData = pm.response.json();",
                  "    pm.expect(jsonData.data).to.be.an('object');",
                  "    pm.environment.set('blacklistId', jsonData.data._id);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"url\": \"https://scam-{{$randomInt}}.com\",\n  \"scamType\": \"phishing\",\n  \"dangerLevel\": \"high\",\n  \"description\": \"Fake banking website\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/blacklist",
              "host": ["{{baseUrl}}"],
              "path": ["api", "blacklist"]
            }
          }
        },
        {
          "name": "Get All Blacklist",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 200', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Response has data array and pagination', function () {",
                  "    const jsonData = pm.response.json();",
                  "    pm.expect(jsonData.data).to.be.an('array');",
                  "    pm.expect(jsonData.pagination).to.be.an('object');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/blacklist?page=1&limit=20",
              "host": ["{{baseUrl}}"],
              "path": ["api", "blacklist"],
              "query": [
                {
                  "key": "page",
                  "value": "1"
                },
                {
                  "key": "limit",
                  "value": "20"
                }
              ]
            }
          }
        },
        {
          "name": "Update Blacklist",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 200', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Response message confirms update', function () {",
                  "    const jsonData = pm.response.json();",
                  "    pm.expect(jsonData.message).to.include('thành công');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"dangerLevel\": \"critical\",\n  \"description\": \"Updated description\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/blacklist/{{blacklistId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "blacklist", "{{blacklistId}}"]
            }
          }
        },
        {
          "name": "Delete Blacklist",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 200', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Response confirms deletion', function () {",
                  "    const jsonData = pm.response.json();",
                  "    pm.expect(jsonData.success).to.be.true;",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/blacklist/{{blacklistId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "blacklist", "{{blacklistId}}"]
            }
          }
        }
      ]
    }
  ],
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:5000",
      "type": "string"
    }
  ]
}
